{% extends "base.html" %}
{% load static %}

{% block content %}
<section class="section dark" style="padding-top: 120px; min-height: 80vh;">
  <div class="container">
    <h1>Personal Space</h1>
    <p class="lead">Welcome to my personal corner. Here I share my hobbies, interests, and non-work related projects.
    </p>

    <div class="grid" style="margin-top: 2rem;">
      <!-- Tile 1: IDs -->
      <div class="card folder-card" onclick="openModal('modal-ids')">
        <h3>ID's</h3>
        <p>View Personal IDs</p>
      </div>

      <!-- Tile 2: Docs -->
      <div class="card folder-card" onclick="openModal('modal-docs')">
        <h3>Docs</h3>
        <p>View Documents</p>
      </div>

      <!-- Tile 3: Photos -->
      <div class="card folder-card" onclick="openModal('modal-photos')">
        <h3>Photos</h3>
        <p>View Photo Gallery</p>
      </div>

      <!-- Tile 4: Others -->
      <div class="card folder-card" onclick="openModal('modal-others')">
        <h3>Others</h3>
        <p>View Other Notes</p>
      </div>
    </div>
  </div>
</section>

<!-- Modals -->
<div id="modal-ids" class="modal">
  <div class="modal-content">
    <span class="close-modal" onclick="closeModal('modal-ids')">&times;</span>
    <h2>ID's</h2>
    <div class="modal-body">
      {% for item in items %}
      {% if item.category == 'IDs' %}
      <div class="modal-item">
        <div style="display: flex; flex-direction: column; gap: 1rem;">
          <div>
            <strong><a href="{% url 'personal_item_detail' item.id %}"
                style="color: inherit; text-decoration: underline;">{{ item.title }}</a></strong>
            {% if item.text_content %}
            <br><span style="opacity: 0.8; font-size: 0.9em;">{{ item.text_content }}</span>
            {% endif %}
          </div>

          <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
            {% for img in item.images.all %}
            <a href="{% url 'personal_item_detail' item.id %}">
              <img src="{{ img.image.url }}" alt="{{ item.title }}"
                style="width: 100px; height: 60px; object-fit: cover; border-radius: 4px; border: 1px solid rgba(255,255,255,0.1);">
            </a>
            {% endfor %}

            {# Fallback for old single image #}
            {% if item.image %}
            <a href="{% url 'personal_item_detail' item.id %}">
              <img src="{{ item.image.url }}" alt="{{ item.title }}"
                style="width: 100px; height: 60px; object-fit: cover; border-radius: 4px; border: 1px solid rgba(255,255,255,0.1);">
            </a>
            {% endif %}
          </div>
        </div>
      </div>
      {% endif %}
      {% endfor %}
    </div>
  </div>
</div>

<div id="modal-docs" class="modal">
  <div class="modal-content">
    <span class="close-modal" onclick="closeModal('modal-docs')">&times;</span>
    <h2>Documents</h2>
    <div class="modal-body">
      {% for item in items %}
      {% if item.category == 'Docs' %}
      <div class="modal-item">
        <a href="{% url 'personal_item_detail' item.id %}" class="doc-link">
          <span class="icon-file">ðŸ“„</span> {{ item.title }}
        </a>
      </div>
      {% endif %}
      {% endfor %}
    </div>
  </div>
</div>

<div id="modal-photos" class="modal">
  <div class="modal-content">
    <span class="close-modal" onclick="closeModal('modal-photos')">&times;</span>
    <h2>Photos</h2>
    <div class="modal-body photo-grid">
      {% for item in items %}
      {% if item.category == 'Photos' %}
      {% if item.image %}
      <a href="{% url 'personal_item_detail' item.id %}" class="photo-item">
        <img src="{{ item.image.url }}" alt="{{ item.title }}">
        <span class="photo-caption">{{ item.title }}</span>
      </a>
      {% endif %}
      {% endif %}
      {% endfor %}
    </div>
  </div>
</div>

<div id="modal-others" class="modal">
  <div class="modal-content">
    <span class="close-modal" onclick="closeModal('modal-others')">&times;</span>
    <h2>Others</h2>
    <div class="modal-body">
      {% for item in items %}
      {% if item.category == 'Others' %}
      <div class="modal-item">
        <strong><a href="{% url 'personal_item_detail' item.id %}"
            style="color: inherit; text-decoration: underline;">{{ item.title }}</a></strong>
        {% if item.text_content %}
        <p style="margin: 0; font-size: 0.9em; opacity: 0.8;">{{ item.text_content }}</p>
        {% endif %}
      </div>
      {% endif %}
      {% endfor %}
    </div>
  </div>
</div>

<script>
  function openModal(id) {
    document.getElementById(id).style.display = "block";
    document.body.style.overflow = "hidden"; // Prevent scrolling
  }

  function closeModal(id) {
    document.getElementById(id).style.display = "none";
    document.body.style.overflow = "auto";
  }

  // Close modal when clicking outside
  window.onclick = function (event) {
    if (event.target.classList.contains('modal')) {
      event.target.style.display = "none";
      document.body.style.overflow = "auto";
    }
  }
</script>

<style>
  /* Modal Styles injected here for simplicity, or move to style.css */
  .folder-card {
    cursor: pointer;
    transition: transform 0.2s;
  }

  .folder-card:hover {
    transform: translateY(-5px);
    border-color: var(--accent);
  }

  .modal {
    display: none;
    position: fixed;
    z-index: 2000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0, 0, 0, 0.8);
    backdrop-filter: blur(5px);
  }

  .modal-content {
    background-color: #1a1a2e;
    margin: 10% auto;
    padding: 2rem;
    border: 1px solid var(--accent);
    width: 80%;
    max-width: 800px;
    border-radius: 15px;
    position: relative;
    box-shadow: 0 0 20px rgba(5, 176, 255, 0.2);
    animation: modalFadeIn 0.3s;
  }

  @keyframes modalFadeIn {
    from {
      opacity: 0;
      transform: translateY(-20px);
    }

    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .close-modal {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
  }

  .close-modal:hover,
  .close-modal:focus {
    color: var(--accent);
    text-decoration: none;
    cursor: pointer;
  }

  .modal-item {
    padding: 1rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  }

  .doc-link {
    color: var(--fg);
    text-decoration: none;
    font-size: 1.1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .doc-link:hover {
    color: var(--accent);
  }

  .photo-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 1rem;
  }

  .photo-item {
    display: block;
    text-decoration: none;
    color: var(--fg);
    text-align: center;
  }

  .photo-item img {
    width: 100%;
    height: 150px;
    object-fit: cover;
    border-radius: 8px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    transition: transform 0.2s;
  }

  .photo-item:hover img {
    transform: scale(1.05);
    border-color: var(--accent);
  }
</style>
{% endblock %}