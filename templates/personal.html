{% extends "base.html" %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/personal-futuristic.css' %}?v=5">

<section class="section cyber-grid-bg" style="padding-top: 120px; min-height: 100vh;">
  <div class="container">
    <div style="text-align: center; margin-bottom: 3rem; position: relative;">
      <h1 class="cyber-glitch-text" data-text="PERSONAL_DATABASE">PERSONAL_DATABASE</h1>
      <p style="color: rgba(0, 245, 255, 0.7); font-family: 'Courier New', monospace; letter-spacing: 1px;">
        > ACCESSING SECURE ARCHIVES...<br>
        > USER: SUPERUSER_ACCESS_GRANTED
      </p>
      <form method="post" action="{% url 'admin:logout' %}" style="position: absolute; top: 0; right: 0;">
        {% csrf_token %}
        <button type="submit"
          style="background: rgba(255, 0, 85, 0.2); border: 1px solid var(--cyber-magenta); color: var(--cyber-magenta); padding: 0.5rem 1.5rem; font-family: 'Courier New', monospace; text-transform: uppercase; letter-spacing: 2px; font-size: 0.8rem; cursor: pointer; transition: all 0.3s ease; clip-path: polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px);">
          <i class="fas fa-sign-out-alt"></i> LOGOUT
        </button>
      </form>
    </div>

    <div class="cyber-dashboard">
      <!-- Module 1: IDs -->
      <div class="cyber-module" onclick="openModal('modal-ids')">
        <div class="cyber-corner tl"></div>
        <div class="cyber-corner tr"></div>
        <div class="cyber-corner bl"></div>
        <div class="cyber-corner br"></div>

        <div class="module-header">
          <i class="fas fa-id-card module-icon"></i>
          <div>
            <div class="module-title">IDENTITY_MODULE</div>
            <span class="module-status">STATUS: ONLINE</span>
          </div>
        </div>
        <p class="module-desc">Access personal identification records and clearance levels.</p>
      </div>

      <!-- Module 2: Docs -->
      <div class="cyber-module" onclick="openModal('modal-docs')">
        <div class="cyber-corner tl"></div>
        <div class="cyber-corner tr"></div>
        <div class="cyber-corner bl"></div>
        <div class="cyber-corner br"></div>

        <div class="module-header">
          <i class="fas fa-file-code module-icon"></i>
          <div>
            <div class="module-title">ARCHIVE_FILES</div>
            <span class="module-status">STATUS: ENCRYPTED</span>
          </div>
        </div>
        <p class="module-desc">Review classified documents, technical specifications, and logs.</p>
      </div>

      <!-- Module 3: Photos -->
      <div class="cyber-module" onclick="openModal('modal-photos')">
        <div class="cyber-corner tl"></div>
        <div class="cyber-corner tr"></div>
        <div class="cyber-corner bl"></div>
        <div class="cyber-corner br"></div>

        <div class="module-header">
          <i class="fas fa-camera-retro module-icon"></i>
          <div>
            <div class="module-title">VISUAL_LOGS</div>
            <span class="module-status">STATUS: AVAILABLE</span>
          </div>
        </div>
        <p class="module-desc">Visual database of field operations and personal captures.</p>
      </div>

      <!-- Module 4: Others -->
      <div class="cyber-module" onclick="openModal('modal-others')">
        <div class="cyber-corner tl"></div>
        <div class="cyber-corner tr"></div>
        <div class="cyber-corner bl"></div>
        <div class="cyber-corner br"></div>

        <div class="module-header">
          <i class="fas fa-database module-icon"></i>
          <div>
            <div class="module-title">MISC_DATA</div>
            <span class="module-status">STATUS: FRAGMENTED</span>
          </div>
        </div>
        <p class="module-desc">Unsorted data fragments and miscellaneous system notes.</p>
      </div>
    </div>
  </div>
</section>

<!-- Modals (Retaining logic but updating styles via CSS) -->
<div id="modal-ids" class="modal">
  <div class="modal-content cyber-modal-content">
    <span class="close-modal" onclick="closeModal('modal-ids')">&times;</span>
    <h2 class="cyber-modal-title">IDENTITY_RECORDS</h2>
    <div class="modal-body">
      {% for item in items %}
      {% if item.category == 'IDs' %}
      <div class="modal-item">
        <div style="display: flex; flex-direction: column; gap: 1rem;">
          <div>
            <strong><a href="{% url 'personal_item_detail' item.id %}" class="cyber-link">{{ item.title }}</a></strong>
            {% if item.text_content %}
            <br><span style="opacity: 0.8; font-size: 0.9em; font-family: 'Courier New';">{{ item.text_content }}</span>
            {% endif %}
          </div>

          <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
            {% for img in item.images.all %}
            <a href="{% url 'personal_item_detail' item.id %}">
              <img src="{{ img.image.url }}" alt="{{ item.title }}"
                style="width: 100px; height: 60px; object-fit: cover; border: 1px solid var(--cyber-cyan);">
            </a>
            {% endfor %}

            {% if item.image %}
            <a href="{% url 'personal_item_detail' item.id %}">
              <img src="{{ item.image.url }}" alt="{{ item.title }}"
                style="width: 100px; height: 60px; object-fit: cover; border: 1px solid var(--cyber-cyan);">
            </a>
            {% endif %}
          </div>
        </div>
      </div>
      {% endif %}
      {% endfor %}
    </div>
  </div>
</div>

<div id="modal-docs" class="modal">
  <div class="modal-content cyber-modal-content">
    <span class="close-modal" onclick="closeModal('modal-docs')">&times;</span>
    <h2 class="cyber-modal-title">ARCHIVE_DOCUMENTS</h2>
    <div class="modal-body">
      {% for item in items %}
      {% if item.category == 'Docs' %}
      <div class="modal-item">
        <a href="{% url 'personal_item_detail' item.id %}" class="doc-link cyber-link">
          <i class="fas fa-file-alt"></i> {{ item.title }}
        </a>
      </div>
      {% endif %}
      {% endfor %}
    </div>
  </div>
</div>

<div id="modal-photos" class="modal">
  <div class="modal-content cyber-modal-content">
    <span class="close-modal" onclick="closeModal('modal-photos')">&times;</span>
    <h2 class="cyber-modal-title">VISUAL_DATABASE</h2>
    <div class="modal-body photo-grid">
      {% for item in items %}
      {% if item.category == 'Photos' %}
      {% if item.image %}
      <a href="{% url 'personal_item_detail' item.id %}" class="photo-item cyber-photo-item">
        <img src="{{ item.image.url }}" alt="{{ item.title }}">
        <span class="photo-caption" style="font-family: 'Courier New'; color: var(--cyber-cyan);">{{ item.title
          }}</span>
      </a>
      {% endif %}
      {% endif %}
      {% endfor %}
    </div>
  </div>
</div>

<div id="modal-others" class="modal">
  <div class="modal-content cyber-modal-content">
    <span class="close-modal" onclick="closeModal('modal-others')">&times;</span>
    <h2 class="cyber-modal-title">MISC_DATA_FRAGMENTS</h2>
    <div class="modal-body">
      {% for item in items %}
      {% if item.category == 'Others' %}
      <div class="modal-item">
        <strong><a href="{% url 'personal_item_detail' item.id %}" class="cyber-link">{{ item.title }}</a></strong>
        {% if item.text_content %}
        <p style="margin: 0; font-size: 0.9em; opacity: 0.8; font-family: 'Courier New';">{{ item.text_content }}</p>
        {% endif %}
      </div>
      {% endif %}
      {% endfor %}
    </div>
  </div>
</div>

<script>
  function openModal(id) {
    document.getElementById(id).style.display = "block";
    document.body.style.overflow = "hidden";
  }

  function closeModal(id) {
    document.getElementById(id).style.display = "none";
    document.body.style.overflow = "auto";
  }

  window.onclick = function (event) {
    if (event.target.classList.contains('modal')) {
      event.target.style.display = "none";
      document.body.style.overflow = "auto";
    }
  }
</script>

{% endblock %}